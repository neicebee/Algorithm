# π’» Hansung Code Camp Problems

## Problem 1 - λ””μ§€ν„Έ ν¬λ μ‹ λ¬Έμ 

### λ¬Έμ  μ •λ³΄
- λ©”μ‹ μ € μ‹¤ν–‰ μ‹ **μ‚¬μ©μκ°€ μ…λ ¥ν•λ” μ«μ(0~9)λ΅ μ΄λ£¨μ–΄μ§„ 5μλ¦¬ ν¨μ¤μ›λ“**
- **PBKDF2-HMAC-SHA256 λ°©μ‹μ„ ν†µν•΄ 16λ°”μ΄νΈμ μ•”νΈ ν‚¤ μƒμ„±**
  - ν‚¤ μƒμ„± μ•κ³ λ¦¬μ¦: PBKDF2-HMAC-SHA256(Password, Salt=0x00*16, IterationCount=10,000, DerivedKeyLength=16)
- ν‰λ¬Έμ„ μ•”νΈ ν‚¤μ™€ **16λ°”μ΄νΈ λ‹¨μ„μ XOR μ—°μ‚°**μ„ ν†µν•΄ μ•”/λ³µνΈν™” μ„¤κ³„
- μ¬λ°”λ¥Έ μ•”νΈ ν‚¤λ΅ μ²« 16λ°”μ΄νΈ λ³µνΈν™” μ‹ λ‹¤μμ ν‰λ¬Έ μ •λ³΄ μ‹λ³„
  - `53 51 4C 69 74 65 20 66 6F 72 6D 61 74 20 33 00 : SQLite format 3.`

<br>

### λ¬Έμ  ν’€μ΄ ν¬μΈνΈ
- 0~9 μ«μλ΅ μ΄λ£¨μ–΄μ§„ 5μλ¦¬ ν¨μ¤μ›λ“μ΄κΈ° λ•λ¬Έμ— Brute-Force Attackμ΄ κ°€λ¥ν•¨
- νμ΄μ¬μ—μ„μ PBKDF2-HMAC-SHA256 λ°©μ‹μ λ©”μ„λ“λ” `hashlib` λ¨λ“μ `pbkdf2_hmac` λ©”μ„λ“ μ‚¬μ©
- μƒμ„± μ•κ³ λ¦¬μ¦μ μ •λ³΄λ“¤μ€ μƒμλ΅ μ„¤μ •
- μƒμ„±λ μ•”νΈ ν‚¤λ΅ ν‰λ¬Έμ„ XOR μ—°μ‚°ν•λ” λ©”μ„λ“ λ”°λ΅ κµ¬ν„
- νμΌ μ „μ²΄κ°€ μ•„λ‹ μ• λ¶€λ¶„μ μ‹κ·Έλ‹μ² λ³µνΈν™” ν›„ sqlite3 νμΌμ μ‹κ·Έλ‹μ²μ™€ μΌμΉν•λ” μ§€ ν™•μΈ
- μΌμΉν•λ©΄ λΉ„λ°€λ²νΈμ™€ λ³µνΈν™”λ νμΌ μƒμ„±

<br>

### κ²°κ³Ό

![code_result](code_result.png)

![db_result](db_result.png)

## Problem 2 - λ””μ§€ν„Έ ν¬λ μ‹ λ¬Έμ 
- apk νμΌ λ¶„μ„ ν›„ μ•”νΈν™”λ μ‚¬μ§„μ„ λ³µνΈν™”ν•μ—¬ μ¦κ±° ν™•λ³΄
- μ‚¬μ©μ λΉ„λ°€λ²νΈ μ…λ ¥ ν›„, ν•΄λ‹Ή μ•”νΈ κΈ°λ°μΌλ΅ ν‚¤λ¥Ό νμƒν•μ—¬ νμΌ AES μ•”νΈν™”
  - λ³„λ„ λ‚λ…ν™” μ΅΄μ¬ X
- AES ν‚¤ νμƒ μ•κ³ λ¦¬μ¦: PBDKF2-HMAC-SHA1
    - νμƒ ν‚¤λ΅ AES-128-CTR μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™” μν–‰

<br>

### λ¬Έμ  ν’€μ΄ ν¬μΈνΈ

![crypto_aes](crypto_aes.png)
- iter: 1,000
- salt: `c8570ac98cc615aa6a6b97b3f20f1b4`
- png νμΌμ μ‹κ·Έλ‹μ²λ” `89504E47 0D0A1A0A`
- κ³ μ •λ salt κ°’κ³Ό μΈμ½”λ”©λ νμΌμ IVκ°€ κ³„μ† λ°λ³µλλ” ν‚¤ μ¬μ‚¬μ©μ„±μ΄λΌλ” μ·¨μ•½μ  λ•λ¬Έμ— XOR μ—°μ‚°μΌλ΅ μ‚¬μ©μμ λΉ„λ°€λ²νΈλ¥Ό μ•μ•„λ‚Ό μ μμ

<br>

## Problem 3 - λ¨Έμ‹ λ¬λ‹ κΈ°λ° μ•”νΈν™” νΈλν”½ λ¶„μ„
- μ•”νΈν™” νΈλν”½μ„ μΈκ³µμ§€λ¥ λ¨λΈμ μ…λ ¥μΌλ΅ μ‚¬μ©ν•κΈ° μ μ ν•λ„λ΅ μ „μ²λ¦¬ μν–‰
  - μ „μ²λ¦¬ λ°©λ²•λ΅ μ— λ”°λΌ μ μ‹λ pcap νμΌμ„ μ „μ²λ¦¬(flow μ¶”μ¶, νΉμ§• κµ¬μ„±, μ •κ·ν™”)λ¥Ό μν–‰ν•μ—¬ λ¨Έμ‹ λ¬λ‹ λ¨λΈμ— ν•™μµμ‹ν‚¬ μ μλ„λ΅ λ°μ΄ν„°μ…‹ κµ¬μ„±
- μ „μ²λ¦¬ λ°©λ²•λ΅ 
  - λ„¤νΈμ›ν¬ νΈλν”½ λ°μ΄ν„°λ” μΌλ°μ μΌλ΅ .pcap νμΌ ν¬λ§·μΌλ΅ μ €μ¥λμ–΄ μμΌλ©°, μ—¬λ¬ flowκ°€ νΌμ¬λμ–΄ μμ
  - Flow-level νΉμ§•μ„ μ¶”μ¶ν•κΈ° μ„ν•΄ νΈλν”½ λ°μ΄ν„°λ¥Ό Flow λ³„λ΅ λ¶„ν• 
    - 5-Tuple(Source IP, Destination IP, Source Port, Destination Port, Protocol)μ„ κΈ°μ¤€μΌλ΅ λ¶„ν• 
    - λ¨λΈμ μ…λ ¥μΌλ΅ μ‚¬μ©ν•κΈ° μ„ν•΄μ„λ” λ°μ΄ν„°μ…‹μ„ κ³ μ •λ κΈΈμ΄, λ™μΌν• ν•μ‹μΌλ΅ μ •κ·ν™” ν•„μ”
      - Standard Scaler
      - Min-Max Scaler
- λ¨Έμ‹ λ¬λ‹ λ¨λΈμ μ…λ ¥μΌλ΅ μ‚¬μ©ν•κΈ° μ„ν•΄ λ‹¤μκ³Ό κ°™μ€ λ‹¨κ³„λ΅ μ•”νΈν™” νΈλν”½ λ°μ΄ν„° μ „μ²λ¦¬λ¥Ό μν–‰ν–μµλ‹λ‹¤.
- pcap νμΌ λ΅λ“: μ κ³µλ '/content/benign.pcap' λ° '/content/malware.pcap' νμΌμ„ Scapy λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ λ΅λ“ν–μµλ‹λ‹¤. λ΅λ“λ μ΄ ν¨ν‚· μλ” **{len(packets)}**κ° μ…λ‹λ‹¤. (μ •μƒ: {len(benign_packets)}κ°, μ•…μ„±: {len(malware_packets)}κ°)
- νλ¦„ μ¶”μ¶ λ° νΉμ§• κµ¬μ„±: λ΅λ“λ ν¨ν‚·μ—μ„ λ°μ΄ν„° νλ¦„(flow)μ„ μ‹λ³„ν•κ³  κ° νλ¦„μ— λ€ν• νΉμ§•μ„ μ¶”μ¶ν–μµλ‹λ‹¤. μ΄ **{len(flows)}**κ°μ νλ¦„μ΄ μ‹λ³„λμ—μΌλ©°, κ° νλ¦„μ— λ€ν•΄ νλ¦„ νΉμ§•κ³Ό λ μ΄λΈ”(flow_label)μ„ ν• λ‹Ήν–μµλ‹λ‹¤.
- λ°μ΄ν„° κµ¬μ΅°ν™”: μ¶”μ¶λ νλ¦„ νΉμ§•λ“¤μ€ pandas DataFrame (flows_df) ν•νƒλ΅ κµ¬μ΅°ν™”λμ—μµλ‹λ‹¤. μ΄ DataFrameμ€ μ΄ **{flows_df.shape[0]}**κ°μ ν–‰(νλ¦„)κ³Ό **{flows_df.shape[1]}**κ°μ μ—΄(νΉμ§• λ° λ μ΄λΈ”)μΌλ΅ κµ¬μ„±λ©λ‹λ‹¤.
- λ°μ΄ν„° μ •κ·ν™”: μ«μν• νΉμ§•λ“¤μ— λ€ν•΄ MinMaxScalerλ¥Ό μ‚¬μ©ν•μ—¬ μ •κ·ν™”λ¥Ό μν–‰ν–μµλ‹λ‹¤.
- λ°μ΄ν„°μ…‹ λ¶„ν• : μ •κ·ν™”λ λ°μ΄ν„°μ…‹μ€ ν•™μµ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ΅ λ¶„ν• λμ—μµλ‹λ‹¤. ν•™μµ μ„ΈνΈλ” {X_train.shape}, ν…μ¤νΈ μ„ΈνΈλ” **{X_test.shape}**μ ν•νƒλ¥Ό κ°€μ§‘λ‹λ‹¤. λ μ΄λΈ”(y_train, y_test)λ„ κ°κ° {y_train.shape}, {y_test.shape} ν•νƒμ…λ‹λ‹¤.

<br>

## Problem 4 - λ¨Έμ‹ λ¬λ‹ κΈ°λ° μ•”νΈν™” νΈλν”½ λ¶„μ„
- μ „μ²λ¦¬λ μ•”νΈν™” νΈλν”½ λ°μ΄ν„°λ¥Ό λ¨Έμ‹ λ¬λ‹ λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μ•…μ„± νΈλν”½μΈμ§€ λλ” μ •μƒ νΈλν”½μΈμ§€λ¥Ό λ¶„λ¥
  - Random Forest, Logistic Regression λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μ „μ²λ¦¬ν• λ°μ΄ν„°μ…‹μ„ ν•™μµμ‹μΌ μ„±λ¥μ„ ν™•μΈ
- μ „μ²λ¦¬λ λ°μ΄ν„°μ…‹μ„ μ‚¬μ©ν•μ—¬ Random Forest λ° Logistic Regression λ¨λΈμ„ ν•™μµμ‹ν‚¤κ³  μ•…μ„± νΈλν”½ λ¶„λ¥ μ„±λ¥μ„ ν‰κ°€ν–μµλ‹λ‹¤.
- Random Forest λ¨λΈ: ν•™μµ κ²°κ³Ό, ν…μ¤νΈ λ°μ΄ν„°μ— λ€ν• μ„±λ¥μ€ **μ •ν™•λ„ 1.0000κ³Ό F1 μ μ 1.0000**μ„ κΈ°λ΅ν–μµλ‹λ‹¤.
- Logistic Regression λ¨λΈ: ν•™μµ κ²°κ³Ό, ν…μ¤νΈ λ°μ΄ν„°μ— λ€ν• μ„±λ¥μ€ **μ •ν™•λ„:1.0000κ³Ό F1 μ μ 1.0000**μ„ κΈ°λ΅ν–μµλ‹λ‹¤.


<br>

## Problem 5 - μ•”νΈν™”
- AESλ΅ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό λ³µκµ¬ν•λΌ
- μ μ ν• μ•”νΈν™” λ°©μ‹μ„ μ„ νƒν•λΌ
```python
# cipher = AES.new(key, AES.MODE_CFB, iv=iv)
# cipher = AES.new(key, AES.MODE_OFB, iv=iv)
# cipher = AES.new(key, AES.MODE_CTR, nonce=nonce)  # β† μ—¬κΈ°!
```
  - ν¨λ”©μ΄ ν•„μ” μ—†κ³ , μ¤νΈλ¦Ό λ°©μ‹(ν‚¤μ¤νΈλ¦Όκ³Ό XOR, "counter increases")μ„ μ‚¬μ©ν•λ‹¤λ” μ μ—μ„ CTR (Counter) λ¨λ“κ°€ μ •λ‹µμ…λ‹λ‹¤.
- μ•”νΈν™” ν‚¤κ°’μ„ μ μ¶”ν•μ‹μ¤.
  - μµμΆ… ν‚¤ λ¬Έμμ—΄ codingcryptogra#

## Problem 6 - μ•”νΈν™”
- Low Public Exponent Attackμ„ RSAμ— μ μ©ν•μ—¬ ν•΄ν‚Ήν•μ‹μ¤.
  - μ μ ν• e κ°’ λ€μ…ν•μ—¬ λ³µνΈν™”
  
![1](KakaoTalk_Photo_2025-09-03-17-28-38.png)
![2](KakaoTalk_Photo_2025-09-03-17-28-44.png)
  - λ°κ²¬λ ν‚¤: e = 17
  - λ³µνΈν™”λ λ©”μ‹μ§€: "camp2025"