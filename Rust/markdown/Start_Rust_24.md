# π¦€ Rust Day 24

## **π³οΈ Smart Pointers**
- ν¬μΈν„°(pointer) : λ©”λ¨λ¦¬μ— μ£Όμ†λ¥Ό κ°€μ§€κ³  μλ” λ³€μλ¥Ό μΌμ»«λ” λ³΄νΈμ μΈ κ°λ…
- λ¬μ¤νΈμ μ°Έμ΅°
  - & κΈ°νΈ μ΄μ©ν•΄ μ§€μ •
  - λ³€μκ°€ κ°€λ¦¬ν‚¤λ” κ°’μ„ λ€μ—¬ν•¨
  - λ³„λ„μ μ¤λ²„ν—¤λ“ μ—†μ
- μ¤λ§νΈ ν¬μΈν„°(smart pointer) : ν¬μΈν„°μ²λΌ λ™μ‘ν•  λΏλ§ μ•„λ‹λΌ μ¶”κ°€μ μΈ λ©”νƒ€λ°μ΄ν„°μ™€ κΈ°λ¥μ„ ν¬ν•¨ν•λ” λ°μ΄ν„° κµ¬μ΅°
  - μ°Έμ΅°λ” λ°μ΄ν„°λ¥Ό λ€μ—¬ν•  μλ§ μμ§€λ§, μ¤λ§νΈ ν¬μΈν„°λ” λ€λ¶€λ¶„ ν¬μΈν„°κ°€ κ°€λ¦¬ν‚¤λ” λ°μ΄ν„°λ¥Ό μ†μ ν•¨
  - `String` κ³Ό `Vec<T>` νƒ€μ… λ¨λ‘ λ©”λ¨λ¦¬λ¥Ό μ†μ ν•λ©° λ°μ΄ν„°λ¥Ό κ°±μ‹ ν•  μ μμΌλ―€λ΅ μ¤λ§νΈ ν¬μΈν„°
    - λ©”νƒ€λ°μ΄ν„°(μ €μ¥ μ©λ‰ λ“±)μ™€ μ¶”κ°€ κΈ°λ¥μ΄λ‚ λ³΄μ¥(Stringμ€ λ¨λ“  λ°μ΄ν„°κ°€ ν•­μƒ μ ν¨ν• UTF-8 λ¬Έμμ„μ„ λ³΄μ¥)μ„ μ κ³µ
  - μ¤λ§νΈ ν¬μΈν„°λ” μ£Όλ΅ κµ¬μ΅°μ²΄λ¥Ό μ΄μ©ν•΄ κµ¬ν„ν•¨
    - μΌλ° κµ¬μ΅°μ²΄μ™€ λ‹¬λ¦¬ Derefμ™€ Drop νΈλ μ΄νΈλ¥Ό κµ¬ν„ν•¨
    - Deref : μ¤λ§νΈ ν¬μΈν„° κµ¬μ΅°μ²΄κ°€ μ°Έμ΅°μ²λΌ λ™μ‘ν•΄μ„ μ°Έμ΅°λ‚ μ¤λ§νΈ ν¬μΈν„°λ¥Ό κ°™μ€ λ°©λ²•μΌλ΅ λ‹¤λ£° μ μλ„λ΅ μ§€μ›
    - Drop : μ¤λ§νΈ ν¬μΈν„°μ μΈμ¤ν„΄μ¤κ°€ λ²”μ„λ¥Ό λ²—μ–΄λ‚  λ• μ„μμ μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ„λ΅ μ§€μ›

### **1οΈβƒ£ `Box<T>` λ¥Ό μ΄μ©ν•΄ ν™ λ©”λ¨λ¦¬μ λ°μ΄ν„° μ°Έμ΅°ν•κΈ°**
- λ°•μ¤(`Box<T>`) : κ°€μ¥ μ§κ΄€μ μΈ μ¤λ§νΈ ν¬μΈν„° 
  - λ°μ΄ν„°λ¥Ό ν™ λ©”λ¨λ¦¬μ— μ €μ¥ν•¨
  - μ¤νƒμ—λ” ν™ λ°μ΄ν„°λ¥Ό κ°€λ¦¬ν‚¤λ” ν¬μΈν„°λ§ μ €μ¥ν•¨
  - λ°•μ¤λ¥Ό μ‚¬μ©ν•λ” μ
    - μ»΄νμΌνƒ€μ„μ— ν¬κΈ°λ¥Ό μ• μ μ—†λ” νƒ€μ…μ„ μ •ν™•ν• ν¬κΈ°κ°€ ν•„μ”ν• μƒν™©μ— μ‚¬μ©ν•λ ¤κ³  ν•  λ•
    - λ°μ΄ν„°μ ν¬κΈ°κ°€ μ»¤μ„ λ°μ΄ν„°λ¥Ό λ³µμ ν•μ§€ μ•κ³  μ†μ κ¶μ„ μ΄μ „ν•κ³  μ‹¶μ„ λ•
    - νΉμ • νƒ€μ…μ΄ μ•„λ‹λΌ νΉμ • νΈλ μ΄νΈλ¥Ό κµ¬ν„ν•λ” νƒ€μ…μ κ°’μ„ μ†μ ν•κ³ μ ν•  λ•

#### **π¤” `Box<T>` λ¥Ό μ΄μ©ν•΄ ν™ λ©”λ¨λ¦¬μ— λ°μ΄ν„° μ €μ¥ν•κΈ°**

```rust
fn main() {
    let b = Box::new(5);
    println!("b = {b}");
}
```
- λ°•μ¤λ¥Ό μ΄μ©ν•΄ i32κ°’μ„ ν™ λ©”λ¨λ¦¬μ— μ €μ¥
  - μ†μ λ κ°’κ³Ό λ§μ°¬κ°€μ§€λ΅ λ°•μ¤κ°€ λ²”μ„λ¥Ό λ²—μ–΄λ‚λ©΄ λ©”λ¨λ¦¬κ°€ ν•΄μ λ¨(λ°•μ¤μ™€ λ°•μ¤κ°€ κ°€λ¦¬ν‚¤λ” λ°μ΄ν„°μ λ©”λ¨λ¦¬κ°€ λ¨λ‘ ν•΄μ )

<br>

#### **π¤” λ°•μ¤λ¥Ό μ΄μ©ν•΄ μ¬κ·€ νƒ€μ… ν™μ©ν•κΈ°**
- μ¬κ·€ νƒ€μ…(recursive type) : κ°™μ€ νƒ€μ…μ λ‹¤λ¥Έ κ°’μ„ μμ‹ μ μΌλ¶€μ— ν¬ν•¨ν•λ” κ°’
  - κ°’μ„ μ¤‘μ²©ν•λ” κ²ƒμ€ μ΄λ΅ μ μΌλ΅ λ¬΄ν•ν•  μ μμ–΄μ„ λ¬μ¤νΈλ” μ¬κ·€ νƒ€μ…μ κ°’μ„ μ €μ¥ν•λ” λ° ν•„μ”ν• κ³µκ°„μ„ νλ‹¨ν•  μ μ—†μ
  - λ°•μ¤μ ν¬κΈ°λ” μ •ν•΄μ Έ μμΌλ―€λ΅ μ¬κ·€ νƒ€μ…μ„ μ„ μ–Έν•  λ• λ°•μ¤λ¥Ό ν™μ©ν•¨

<br>

**(1)** λ¦¬μ¤νΈ μƒμ„±μμ— λ€ν• λ” μμ„Έν• μ •λ³΄
- μ½μ¤ λ¦¬μ¤νΈ(cons list; construction list) : λ¦¬μ¤ν”„(Lisp) ν”„λ΅κ·Έλλ° μ–Έμ–΄ λ° νμƒ μ–Έμ–΄μ— λ„μ…λ λ°μ΄ν„° κµ¬μ΅°
  - λ¦¬μ¤ν”„μ cons ν•¨μλ” λ³΄ν†µ ν•λ‚μ κ°’κ³Ό κ°’μ μμΌλ΅ κµ¬μ„±λ λ‘ κ°μ μΈμλ¥Ό μ΄μ©ν•΄ μƒλ΅μ΄ μμ„ μƒμ„±ν•λ©° μ΄ μμ„ ν¬ν•¨ν•λ” μμ΄ λ¦¬μ¤νΈλ¥Ό κµ¬μ„±ν•κ² λ¨
  - μ½μ¤ λ¦¬μ¤νΈμ κ° μ•„μ΄ν…μ€ ν„μ¬ μ•„μ΄ν…μ κ°’κ³Ό κ·Έ λ‹¤μ μ•„μ΄ν…μ κ°’ λ“± λ‘ κ°μ μ›μ†λ΅ κµ¬μ„±λ¨
    - λ¦¬μ¤νΈμ λ§μ§€λ§‰ μ•„μ΄ν…μ€ λ‹¤μ μ•„μ΄ν…μ΄ μ—†μΌλ―€λ΅ Nil μ΄λΌλ” κ°’μ„ κ°€μ§
  - μ΄ λ¦¬μ¤νΈλ” μ½μ¤ ν•¨μλ¥Ό μ¬κ·€μ μΌλ΅ νΈμ¶ν•΄μ„ μƒμ„±ν•¨
  - μ¬κ·€μ κΈ°λ³Έ μƒνƒ(base case)λ¥Ό λ»ν•λ” μ •μ‹ λ…μΉ­μ€ Nil
  - μ½μ¤ λ¦¬μ¤νΈλ” ν•¨μν• ν”„λ΅κ·Έλλ° μ–Έμ–΄μ—μ„λ” μ‚¬μ© λΉλ„κ°€ λ†’μ§€λ§, λ¬μ¤νΈλ” λ³΄νΈμ μΌλ΅ μ‚¬μ©ν•μ§€ μ•μ
- 'xλ¥Ό yμ— μ½μ¤ν•λ‹¤' : μ›μ† xλ¥Ό y λ¦¬μ¤νΈμ μ²« λ¶€λ¶„μ— μ¶”κ°€ν•΄μ„ μƒλ΅μ΄ λ¦¬μ¤νΈλ¥Ό μƒμ„±ν•λ‹¤λ” μλ―Έ

```rust
enum List {
    Cons(i32, List),
    Nil,
}
```
- i32 κ°’μ μ½μ¤ λ¦¬μ¤νΈ λ°μ΄ν„° κµ¬μ΅°λ¥Ό ν‘ν„ν•λ” μ—΄κ±°μ

```rust
use crate::List::{Cons, Nil};

fn main() {
    let list = Cons(1, Cons(2, Cons(3, Nil)));
}
```
- List μ—΄κ±°μλ¥Ό μ΄μ©ν•΄ 1, 2, 3 λ©λ΅ μ €μ¥
- `recursive type List has infinite size` μ—λ¬ λ°μƒ
  - μ–΄λ μ •λ„μ λ©”λ¨λ¦¬ κ³µκ°„μ΄ ν•„μ”ν•μ§€ νλ‹¨ν•  μ μ—†κΈ° λ•λ¬Έ

<br>

**(2)** λΉ„μ¬κ·€ νƒ€μ…μ ν¬κΈ°λ¥Ό κ³„μ‚°ν•λ” λ°©λ²•

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}
```
- λ¬μ¤νΈλ” Message κ°’μ„ μ €μ¥ν•λ” λ° ν•„μ”ν• κ³µκ°„μ„ κ²°μ •ν•κΈ° μ„ν•΄ κ° μ—΄κ²ƒκ°’μ„ λ¨λ‘ ν™•μΈν•΄μ„ μ–΄λ–¤ μ—΄κ²ƒκ°’μ΄ λ” λ§μ€ κ³µκ°„μ„ μ°¨μ§€ν•λ”μ§€ ν™•μΈν•¨
- λ‹¨ ν•λ‚μ μ—΄κ²ƒκ°’λ§ μ‚¬μ©ν•λ―€λ΅ Message κ°’μ΄ ν•„μ”λ΅ ν•λ” κ³µκ°„μ€ κ°€μ¥ ν° μ—΄κ²ƒκ°’μ„ μ €μ¥ν•λ” λ° ν•„μ”ν• κ³µκ°„μ„

```rust
enum List {
    Cons(i32, List),
    Nil,
}
```
- μ»΄νμΌλ¬λ” Cons μ—΄κ²ƒκ°’μ„ λ¨Όμ € ν™•μΈν•¨
  - i32 νƒ€μ…κ³Ό List νƒ€μ…μ κ°’ μ €μ¥
  - Consλ” i32 νƒ€μ…μ ν¬κΈ°μ— List νƒ€μ…μ ν¬κΈ°λ¥Ό λ”ν• κ³µκ°„μ΄ ν•„μ”ν•¨
  - List νƒ€μ…μ— ν•„μ”ν• κ³µκ°„μ„ ν™•μΈν•κΈ° μ„ν•΄ μ»΄νμΌλ¬λ” λ‹¤μ‹ Cons μ—΄κ²ƒκ°’λ¶€ν„° μ‚΄ν΄λ³΄κΈ° μ‹μ‘ν•¨ -> λ¬΄ν•ν•κ² λ°λ³µλ¨

<br>

**(3)** `Box<T>` λ¥Ό μ΄μ©ν•΄μ„ μ¬κ·€ νƒ€μ…μ ν¬κΈ° κ²°μ •ν•κΈ°

```rust
enum List {
    Cons(i32, Box<List>),
    Nil,
}

use List::{Cons, Nil};

fn main() {
    let list = Cons(1,
        Box::new(Cons(2, 
            Box::new(Cons(3,
                Box::new(Nil))))));
}
```
- ν¬κΈ°λ¥Ό μ•κ³  μλ” λ°•μ¤λ¥Ό μ΄μ©ν•΄ λ‹¤μ‹ μ„ μ–Έν• List μ—΄κ±°μ
  - `Box<T>` λ” ν¬μΈν„°μ΄λ―€λ΅ λ¬μ¤νΈλ” λ°•μ¤κ°€ ν•„μ”ν• κ³µκ°„μ΄ μ–Όλ§μΈμ§€ μ•κ³  μμ
  - `Box<T>` λ” Cons μ—΄κ²ƒκ°’μ— μ €μ¥λ λ°μ΄ν„°κ°€ μ•„λ‹λΌ, ν™ λ©”λ¨λ¦¬μ— μ €μ¥λ λ‹¤μ Listμ κ°’μ„ κ°€λ¦¬ν‚΄
    - μ΄λ΅ μ μΌλ΅λ” λ‹¤λ¥Έ λ¦¬μ¤νΈλ¥Ό 'μ €μ¥ν•κ³  μλ”' λ¦¬μ¤νΈλ¥Ό κ°€μ§€κ² λ¨
    - ν• λ¦¬μ¤νΈ μ•μ— λ‹¤λ¥Έ λ¦¬μ¤νΈλ¥Ό μ €μ¥ν•λ” κ²ƒμ΄ μ•„λ‹ ν• λ¦¬μ¤νΈ μ†μ— λ‹¤λ¥Έ μ•„μ΄ν…μ„ μ €μ¥ν•λ” μ…
- λ°•μ¤λ” κ°’μ κ°„μ ‘μ μΈ μ €μ¥κ³Ό ν™ λ©”λ¨λ¦¬ ν• λ‹Ήλ§ μ§€μ›ν•λ―€λ΅ μ–΄λ– ν• μ„±λ¥ μ¤λ²„ν—¤λ“λ„ λ°μƒν•μ§€ μ•μ